#
# Controller for the list of exploits
#

require_relative '../build/exploit'

module RCS
module DB

class ExploitController < RESTController

  def index
    require_auth_level :tech
    require_auth_level :tech_build

    exploits = Exploit.all

    exploits.sort! {|x,y| x['name'] <=> y['name']}

    ok(exploits)
  end

  def show
    require_auth_level :tech
    require_auth_level :tech_build

    version = {version: Exploit.version}

    ok(version)
  end

end

end #DB::
end #RCS::